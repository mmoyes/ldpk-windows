<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ldpk: /server/devel/sdv/privat/uwe/source/ldpk/include/ldpk/ldpk_ldp_builtin.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="ldpk"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ldpk
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_7562954dc898867da1ed298f0b6ca777.html">ldpk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ldpk_ldp_builtin.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef ldp_builtin_sdv</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define ldp_builtin_sdv</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ldpk__vec2d_8h.html">ldpk/ldpk_vec2d.h</a>&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;ldpk/tde4_ld_plugin.h&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ldpk__lookup__table_8h.html">ldpk/ldpk_lookup_table.h</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceldpk.html">ldpk</a></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        {</div><div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">   13</a></span>&#160;        <span class="keyword">enum</span> <a class="code" href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">para_builtin_enum</a></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                para_not_a_builtin = -1,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                para_focal_length = 0,</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                para_filmback_width = 1,</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                para_filmback_height = 2,</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                para_lens_center_offset_x = 3,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                para_lens_center_offset_y = 4,</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                para_pixel_aspect = 5,</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                para_custom_focus_distance = 6</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                };</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> VEC2,<span class="keyword">class</span> MAT2&gt;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html">   31</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classldpk_1_1ldp__builtin.html">ldp_builtin</a>:<span class="keyword">public</span> <a class="code" href="classtde4__ld__plugin.html">tde4_ld_plugin</a></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keyword">private</span>:</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="keyword">typedef</span> VEC2 vec2_type;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="keyword">typedef</span> MAT2 mat2_type;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <span class="keyword">typedef</span> <a class="code" href="classldpk_1_1box.html">box&lt;VEC2&gt;</a> <a class="code" href="classldpk_1_1box.html">box2_type</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* _para_builtin[7];</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                <span class="keywordtype">double</span> _value_builtin[7];</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                <span class="keywordtype">double</span> _r_fb_cm;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <a class="code" href="classldpk_1_1lookup__table.html">ldpk::lookup_table&lt;vec2_type&gt;</a> _lut;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="keywordtype">bool</span> _uptodate_lut;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <a class="code" href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">para_builtin_enum</a> find_builtin_parameter_by_name(<span class="keyword">const</span> <span class="keywordtype">char</span>* identifier) <span class="keyword">const</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keyword">static</span> <span class="keywordtype">int</span> compute_extremal_parameters_of_spline(       <span class="keyword">const</span> vec2_type&amp; qa,<span class="keyword">const</span> vec2_type&amp; qb,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                                                        <span class="keyword">const</span> vec2_type&amp; dqa,<span class="keyword">const</span> vec2_type&amp; dqb,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                                        <span class="keywordtype">double</span>* t_out)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                        {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        vec2_type b = dqa;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        vec2_type c = -3.0 * qa + 3.0 * qb - 2.0 * dqa - dqb;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        vec2_type d =  2.0 * qa - 2.0 * qb +       dqa + dqb;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                        vec2_type disc;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        <span class="keywordtype">int</span> i_out = 0;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0;i &lt; 2;++i)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                <span class="keywordflow">if</span>(d[i] != 0.0)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                        {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                        <span class="keywordtype">double</span> d_mul_3 = 3.0 * d[i];</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                        disc[i] = (c[i] * c[i]) / (d_mul_3 * d_mul_3) - b[i] / d_mul_3;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">// equal 0 means saddle point, i.e. not an extreme value, less than 0 means no extremum and np saddle point.</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// We are only interested in local extrema, therefore we check against 0.0 and 1.0.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                        <span class="keywordflow">if</span>(disc[i] &gt; 0.0)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                                {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                                <span class="keywordtype">double</span> t,r = sqrt(disc[i]);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                                t = -c[i] / d_mul_3 + r;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                <span class="keywordflow">if</span>((t &gt; 0.0) &amp;&amp; (t &lt; 1.0))</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                        { t_out[i_out++] = t; }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                                t = -c[i] / d_mul_3 - r;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                <span class="keywordflow">if</span>((t &gt; 0.0) &amp;&amp; (t &lt; 1.0))</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                                        { t_out[i_out++] = t; }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                        }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(c[i] != 0.0)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                        {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// Not a cubic polynomial? Treat as quadratic.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                        <span class="keywordtype">double</span> t = b[i] / (-2.0 * c[i]);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                        <span class="keywordflow">if</span>((t &gt; 0.0) &amp;&amp; (t &lt; 1.0))</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                { t_out[i_out++] = t; }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                        }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="keywordflow">return</span> i_out;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> I&gt; <span class="keywordtype">void</span> extend_box_by_spline(     <span class="keyword">const</span> vec2_type&amp; pa,<span class="keyword">const</span> vec2_type&amp; pb,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                <span class="keyword">const</span> vec2_type&amp; qa,<span class="keyword">const</span> vec2_type&amp; qb,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                                                <span class="keyword">const</span> mat2_type&amp; ja,<span class="keyword">const</span> mat2_type&amp; jb,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                                box2_type&amp; bbox)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        <span class="keywordtype">double</span> t_out[4];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        vec2_type dqa = ja * (pb - pa);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        vec2_type dqb = jb * (pb - pa);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <span class="keywordtype">int</span> n_out = compute_extremal_parameters_of_spline(qa,qb,dqa,dqb,t_out);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0;i &lt; n_out;++i)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                <span class="keywordflow">if</span>((t_out[i] &lt;= 0.0) || (t_out[i] &gt;= 1.0))</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                        { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldpk::ldp_builtin: extend_box_by_spline: implementation error, needs fix.&quot;</span> &lt;&lt; std::endl; }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                vec2_type qt,pt;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                pt = (1.0 - t_out[i]) * pa + t_out[i] * pb;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                qt = apply_mapping&lt;I&gt;(pt);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                bbox.extend(qt);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> I&gt; mat2_type get_jacobian_matrix(<span class="keyword">const</span> vec2_type&amp; p,<span class="keyword">const</span> vec2_type&amp; q)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        mat2_type j;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                        <span class="keywordflow">if</span>(I)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                <a class="code" href="classtde4__ld__plugin.html#a31128ad1bee0ea540a7764fbd1998bf5">getJacobianMatrix</a>(p[0],p[1],j[0][0],j[0][1],j[1][0],j[1][1]);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                <span class="keywordflow">return</span> j;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// Checked with difference quotients. This is called the Inverse Function Theorem.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                <a class="code" href="classtde4__ld__plugin.html#a31128ad1bee0ea540a7764fbd1998bf5">getJacobianMatrix</a>(q[0],q[1],j[0][0],j[0][1],j[1][0],j[1][1]);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                <span class="keywordflow">return</span> invert(j);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                        }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> I&gt; vec2_type apply_mapping(<span class="keyword">const</span> vec2_type&amp; p)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        vec2_type q;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        <span class="keywordflow">if</span>(I)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                { <a class="code" href="classtde4__ld__plugin.html#ace0cb2b24f2f3f291029d2785b5ac228">undistort</a>(p[0],p[1],q[0],q[1]); }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                { distort(p[0],p[1],q[0],q[1]); }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        <span class="keywordflow">return</span> q;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> I&gt; <span class="keywordtype">void</span> get_bounding_box( <span class="keywordtype">double</span> xa_in,<span class="keywordtype">double</span> ya_in,<span class="keywordtype">double</span> xb_in,<span class="keywordtype">double</span> yb_in,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                        <span class="keywordtype">double</span>&amp; xa_out,<span class="keywordtype">double</span>&amp; ya_out,<span class="keywordtype">double</span>&amp; xb_out,<span class="keywordtype">double</span>&amp; yb_out,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                                        <span class="keywordtype">int</span> nx,<span class="keywordtype">int</span> ny)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <span class="keywordtype">double</span> dx_in = xb_in - xa_in,dy_in = yb_in - ya_in;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        box2_type bbox;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                        vec2_type pa,pb;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        vec2_type qa,qb;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        mat2_type ja,jb;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// ya_in</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        pb = vec2_type(xa_in,ya_in);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        bbox.extend(qb);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix = 1;ix &lt;= nx;++ix)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                <span class="keywordtype">double</span> x_in = xa_in + dx_in * double(ix) / nx;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                <span class="keywordtype">double</span> y_in = ya_in;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">// original</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                pa = pb;qa = qb;ja = jb;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                pb = vec2_type(x_in,y_in);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                extend_box_by_spline&lt;I&gt;(pa,pb,qa,qb,ja,jb,bbox);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                bbox.extend(qb);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">// yb_in</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        pb = vec2_type(xa_in,yb_in);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        bbox.extend(qb);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix = 1;ix &lt;= nx;++ix)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                <span class="keywordtype">double</span> x_in = xa_in + dx_in * double(ix) / nx;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                <span class="keywordtype">double</span> y_in = yb_in;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">// copy-paste</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                pa = pb;qa = qb;ja = jb;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                pb = vec2_type(x_in,y_in);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                extend_box_by_spline&lt;I&gt;(pa,pb,qa,qb,ja,jb,bbox);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                bbox.extend(qb);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">// xa_in</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        pb = vec2_type(xa_in,ya_in);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        bbox.extend(qb);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy = 1;iy &lt;= ny;++iy)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                <span class="keywordtype">double</span> x_in = xa_in;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                <span class="keywordtype">double</span> y_in = ya_in + dy_in * double(iy) / ny;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">// copy-paste</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                pa = pb;qa = qb;ja = jb;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                pb = vec2_type(x_in,y_in);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                extend_box_by_spline&lt;I&gt;(pa,pb,qa,qb,ja,jb,bbox);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                bbox.extend(qb);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// xb_in</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        pb = vec2_type(xb_in,ya_in);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        bbox.extend(qb);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy = 1;iy &lt;= ny;++iy)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                <span class="keywordtype">double</span> x_in = xb_in;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                <span class="keywordtype">double</span> y_in = ya_in + dy_in * double(iy) / ny;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// copy-paste</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                pa = pb;qa = qb;ja = jb;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                pb = vec2_type(x_in,y_in);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                qb = apply_mapping&lt;I&gt;(pb);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                jb = get_jacobian_matrix&lt;I&gt;(pb,qb);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                extend_box_by_spline&lt;I&gt;(pa,pb,qa,qb,ja,jb,bbox);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                bbox.extend(qb);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        xa_out = bbox.a()[0];</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        ya_out = bbox.a()[1];</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        xb_out = bbox.b()[0];</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        yb_out = bbox.b()[1];</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">protected</span>:</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a494126e85487ed51de38c567abdcae69">  242</a></span>&#160;                CRITICAL_SECTION <a class="code" href="classldpk_1_1ldp__builtin.html#a494126e85487ed51de38c567abdcae69">_critsec</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                pthread_mutex_t _mutex;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordtype">bool</span> <a class="code" href="classldpk_1_1ldp__builtin.html#ae33a7bacc31a24bb0635dfc7c745e3ec">is_uptodate_lut</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _uptodate_lut; }</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a48671e71653cd4f604c6f8f55a84f799">  256</a></span>&#160;                <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a48671e71653cd4f604c6f8f55a84f799">no_longer_uptodate_lut</a>()</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        { _uptodate_lut = <span class="keyword">false</span>; }</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a371a4a602a0dee64ab4be471c1c383e1">  259</a></span>&#160;                <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a371a4a602a0dee64ab4be471c1c383e1">set_uptodate_lut</a>(<span class="keywordtype">bool</span> u)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        { _uptodate_lut = u; }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a2de5a810eb4fdf0938b58c4658000fd9">update_lut</a>();</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#aef6d9baf1d9321bc764a2c6492fe2208">  265</a></span>&#160;                <span class="keyword">const</span> <a class="code" href="classldpk_1_1lookup__table.html">ldpk::lookup_table&lt;vec2_type&gt;</a>&amp; <a class="code" href="classldpk_1_1ldp__builtin.html#aef6d9baf1d9321bc764a2c6492fe2208">get_lut</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _lut; }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classldpk_1_1ldp__builtin.html#ac328b74c578aa5adf7f23285eb7ae28d">get_num_builtin_parameters</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> 7; }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordtype">bool</span> <a class="code" href="classldpk_1_1ldp__builtin.html#adbac9011ec420283903e339aa89e49b7">set_builtin_parameter_value</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* identifier,<span class="keywordtype">double</span> v);</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#aefe00fe66885527a66086c7de7ada14e">  277</a></span>&#160;                <span class="keywordtype">bool</span> <a class="code" href="classldpk_1_1ldp__builtin.html#aefe00fe66885527a66086c7de7ada14e">get_builtin_parameter_type</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* identifier,tde4_ldp_ptype&amp; ptype)<span class="keyword"> const</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">                        </span>{</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                        <span class="keywordflow">if</span>(find_builtin_parameter_by_name(identifier) != para_not_a_builtin)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                ptype = TDE4_LDP_DOUBLE;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        }</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#abf9af2aadba2940b721986645130c7e2">  290</a></span>&#160;                <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#abf9af2aadba2940b721986645130c7e2">check_builtin_parameters</a>()</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        <span class="keywordflow">if</span>(w_fb_cm() == 0)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldp_builtin: filmback width is 0.&quot;</span> &lt;&lt; std::endl; }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        <span class="keywordflow">if</span>(h_fb_cm() == 0)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldp_builtin: filmback height is 0.&quot;</span> &lt;&lt; std::endl; }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        <span class="keywordflow">if</span>(fl_cm() == 0)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldp_builtin: focal length is 0.&quot;</span> &lt;&lt; std::endl; }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <span class="keywordflow">if</span>(pa() == 0)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldp_builtin: pixel aspect is 0.&quot;</span> &lt;&lt; std::endl; }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        _r_fb_cm = sqrt(w_fb_cm() * w_fb_cm() + h_fb_cm() * h_fb_cm()) / 2.0;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                vec2_type map_unit_to_dn(<span class="keyword">const</span> vec2_type&amp; p_unit)<span class="keyword"> const</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">                        </span>{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        vec2_type p_cm((p_unit[0] - 1.0/2.0) * w_fb_cm() - x_lco_cm(),(p_unit[1] - 1.0/2.0) * h_fb_cm() - y_lco_cm());</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        <span class="keywordflow">return</span> p_cm / r_fb_cm();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                vec2_type map_dn_to_unit(<span class="keyword">const</span> vec2_type&amp; p_dn)<span class="keyword"> const</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keyword">                        </span>{</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        vec2_type p_cm(p_dn * r_fb_cm());</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        p_cm += vec2_type(w_fb_cm() / 2 + x_lco_cm(),h_fb_cm() / 2 + y_lco_cm());</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <span class="keywordflow">return</span> vec2_type(p_cm[0] / w_fb_cm(),p_cm[1] / h_fb_cm());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keywordtype">void</span> lock()</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        EnterCriticalSection(&amp;_critsec);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        pthread_mutex_lock(&amp;this-&gt;_mutex);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                        }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordtype">void</span> unlock()</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        LeaveCriticalSection(&amp;_critsec);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        pthread_mutex_unlock(&amp;this-&gt;_mutex);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <a class="code" href="classldpk_1_1ldp__builtin.html">ldp_builtin</a>():_uptodate_lut(<span class="keyword">false</span>)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        InitializeCriticalSection(&amp;_critsec);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <span class="keywordtype">int</span> r = pthread_mutex_init(&amp;_mutex,NULL);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <span class="keywordflow">if</span>(r)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldpk::ldp_builtin::pthread_mutex_init: &quot;</span> &lt;&lt; strerror(r) &lt;&lt; std::endl; }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">// We set all built-in parameters to zero. That way we can reliably find out</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">// if the application initializies properly (i.e. pixel aspect needs to be set).</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0;i &lt; <a class="code" href="classldpk_1_1ldp__builtin.html#ac328b74c578aa5adf7f23285eb7ae28d">get_num_builtin_parameters</a>();++i)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                { _value_builtin[i] = 0; }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keyword">virtual</span> ~<a class="code" href="classldpk_1_1ldp__builtin.html">ldp_builtin</a>()</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                        {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        DeleteCriticalSection(&amp;_critsec);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        <span class="keywordtype">int</span> r = pthread_mutex_destroy(&amp;_mutex);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        <span class="keywordflow">if</span>(r)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                { std::cerr &lt;&lt; <span class="stringliteral">&quot;ldpk::ldp_builtin::pthread_mutex_destroy: &quot;</span> &lt;&lt; strerror(r) &lt;&lt; std::endl; }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordtype">double</span> w_fb_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_filmback_width]; }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordtype">double</span> h_fb_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_filmback_height]; }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="keywordtype">double</span> x_lco_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_lens_center_offset_x]; }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordtype">double</span> y_lco_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_lens_center_offset_y]; }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordtype">double</span> fl_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_focal_length]; }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keywordtype">double</span> pa()<span class="keyword"> const</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_pixel_aspect]; }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordtype">double</span> fd_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _value_builtin[para_custom_focus_distance]; }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordtype">double</span> r_fb_cm()<span class="keyword"> const</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keyword">                        </span>{ <span class="keywordflow">return</span> _r_fb_cm; }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#aca0898bd49a2f2c19a4f4f8dac144d1d">  382</a></span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classldpk_1_1ldp__builtin.html#aca0898bd49a2f2c19a4f4f8dac144d1d">undistort_gnomonic</a>(<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> &amp;x1, <span class="keywordtype">double</span> &amp;y1)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                { <span class="keywordflow">return</span> <a class="code" href="classtde4__ld__plugin.html#ace0cb2b24f2f3f291029d2785b5ac228">undistort</a>(x0,y0,x1,y1); }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> distort_gnomonic(<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> &amp;x1, <span class="keywordtype">double</span> &amp;y1)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                { <span class="keywordflow">return</span> distort(x0,y0,x1,y1); }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> distort_gnomonic(<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1_start , <span class="keywordtype">double</span> y1_start, <span class="keywordtype">double</span> &amp;x1, <span class="keywordtype">double</span> &amp;y1)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                { <span class="keywordflow">return</span> distort(x0,y0,x1_start,y1_start,x1,y1); }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a6606d28b6b95a67fa50e462fd728e37b">  391</a></span>&#160;                <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a6606d28b6b95a67fa50e462fd728e37b">getBoundingBoxUndistort</a>(<span class="keywordtype">double</span> xa_in,<span class="keywordtype">double</span> ya_in,<span class="keywordtype">double</span> xb_in,<span class="keywordtype">double</span> yb_in,<span class="keywordtype">double</span>&amp; xa_out,<span class="keywordtype">double</span>&amp; ya_out,<span class="keywordtype">double</span>&amp; xb_out,<span class="keywordtype">double</span>&amp; yb_out,<span class="keywordtype">int</span> nx,<span class="keywordtype">int</span> ny)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        { get_bounding_box&lt;1&gt;(xa_in,ya_in,xb_in,yb_in,xa_out,ya_out,xb_out,yb_out,nx,ny); }</div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a1a8cfc61ada03f7de56b91027404cec8">  393</a></span>&#160;                <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a1a8cfc61ada03f7de56b91027404cec8">getBoundingBoxDistort</a>(<span class="keywordtype">double</span> xa_in,<span class="keywordtype">double</span> ya_in,<span class="keywordtype">double</span> xb_in,<span class="keywordtype">double</span> yb_in,<span class="keywordtype">double</span>&amp; xa_out,<span class="keywordtype">double</span>&amp; ya_out,<span class="keywordtype">double</span>&amp; xb_out,<span class="keywordtype">double</span>&amp; yb_out,<span class="keywordtype">int</span> nx,<span class="keywordtype">int</span> ny)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        { get_bounding_box&lt;0&gt;(xa_in,ya_in,xb_in,yb_in,xa_out,ya_out,xb_out,yb_out,nx,ny); }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                };</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">// Built-in parameter names. Do not change.</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> VEC2,<span class="keyword">class</span> MAT2&gt;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classldpk_1_1ldp__builtin.html">ldp_builtin&lt;VEC2,MAT2&gt;::_para_builtin</a>[7] = {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="stringliteral">&quot;tde4_focal_length_cm&quot;</span>,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="stringliteral">&quot;tde4_filmback_width_cm&quot;</span>,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="stringliteral">&quot;tde4_filmback_height_cm&quot;</span>,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="stringliteral">&quot;tde4_lens_center_offset_x_cm&quot;</span>,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="stringliteral">&quot;tde4_lens_center_offset_y_cm&quot;</span>,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="stringliteral">&quot;tde4_pixel_aspect&quot;</span>,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="stringliteral">&quot;tde4_custom_focus_distance_cm&quot;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                };</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> VEC2,<span class="keyword">class</span> MAT2&gt;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">para_builtin_enum</a> <a class="code" href="classldpk_1_1ldp__builtin.html">ldp_builtin&lt;VEC2,MAT2&gt;::find_builtin_parameter_by_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* identifier)<span class="keyword"> const</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keyword">                </span>{</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0;i &lt; <a class="code" href="classldpk_1_1ldp__builtin.html#ac328b74c578aa5adf7f23285eb7ae28d">get_num_builtin_parameters</a>();++i)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="keywordflow">if</span>(strcmp(_para_builtin[i],identifier) == 0)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">para_builtin_enum</a>(i);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">return</span> para_not_a_builtin;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> VEC2,<span class="keyword">class</span> MAT2&gt;</div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#adbac9011ec420283903e339aa89e49b7">  422</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classldpk_1_1ldp__builtin.html#adbac9011ec420283903e339aa89e49b7">ldp_builtin&lt;VEC2,MAT2&gt;::set_builtin_parameter_value</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* identifier,<span class="keywordtype">double</span> v)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <span class="keywordtype">int</span> i = find_builtin_parameter_by_name(identifier);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <span class="keywordflow">if</span>(i &lt; 0)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                        { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">if</span>(_value_builtin[i] != v)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">// Whenever a parameter is changed, the lookup table becomes obsolete.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        <a class="code" href="classldpk_1_1ldp__builtin.html#a48671e71653cd4f604c6f8f55a84f799">no_longer_uptodate_lut</a>();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        _value_builtin[i] = v;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> VEC2,<span class="keyword">class</span> MAT2&gt;</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classldpk_1_1ldp__builtin.html#a2de5a810eb4fdf0938b58c4658000fd9">  436</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classldpk_1_1ldp__builtin.html#a2de5a810eb4fdf0938b58c4658000fd9">ldp_builtin&lt;VEC2,MAT2&gt;::update_lut</a>()</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                _lut.<a class="code" href="classldpk_1_1lookup__table.html#aa27eb18e62b7a3e1e3323c1b28f61f87">init</a>(45,45);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                _lut.<a class="code" href="classldpk_1_1lookup__table.html#ad2bbeafbc1fadf9a8975cb9de90549e8">reset</a>();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">while</span>(_lut.<a class="code" href="classldpk_1_1lookup__table.html#ae1852ef4009246f661742ef98ee9485f">next</a>())</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                        {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        vec2_type qs = _lut.<a class="code" href="classldpk_1_1lookup__table.html#afb7166cc349973f3a3c69b818fdbf656">get_current_initial_value</a>();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                        vec2_type q,p = _lut.<a class="code" href="classldpk_1_1lookup__table.html#af948515de1e3ebc1119023b21d94a9c2">get_p_current_fov</a>();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">// Call the inverse model function with initial values.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        distort_gnomonic(p[0],p[1],qs[0],qs[1],q[0],q[1]);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        _lut.<a class="code" href="classldpk_1_1lookup__table.html#a81ad0186a55f2e05d352b4a91dfd3529">set_q_current_fov</a>(q);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="classldpk_1_1ldp__builtin.html#a371a4a602a0dee64ab4be471c1c383e1">set_uptodate_lut</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classtde4__ld__plugin_html_ace0cb2b24f2f3f291029d2785b5ac228"><div class="ttname"><a href="classtde4__ld__plugin.html#ace0cb2b24f2f3f291029d2785b5ac228">tde4_ld_plugin::undistort</a></div><div class="ttdeci">virtual bool undistort(double x0, double y0, double &amp;x1, double &amp;y1)=0</div><div class="ttdoc">warp/unwarp 2D points... </div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a1a8cfc61ada03f7de56b91027404cec8"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a1a8cfc61ada03f7de56b91027404cec8">ldpk::ldp_builtin::getBoundingBoxDistort</a></div><div class="ttdeci">virtual void getBoundingBoxDistort(double xa_in, double ya_in, double xb_in, double yb_in, double &amp;xa_out, double &amp;ya_out, double &amp;xb_out, double &amp;yb_out, int nx, int ny)</div><div class="ttdoc">Iterate around the specified box, distort the points and compute the bounding box. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:393</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_ae1852ef4009246f661742ef98ee9485f"><div class="ttname"><a href="classldpk_1_1lookup__table.html#ae1852ef4009246f661742ef98ee9485f">ldpk::lookup_table::next</a></div><div class="ttdeci">bool next()</div><div class="ttdoc">False means no value to be generated, loop is done. See example. </div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:203</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a2de5a810eb4fdf0938b58c4658000fd9"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a2de5a810eb4fdf0938b58c4658000fd9">ldpk::ldp_builtin::update_lut</a></div><div class="ttdeci">virtual void update_lut()</div><div class="ttdoc">Update the lookup table. The derived class will do this, if necessary, when distort() without initial...</div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:436</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html"><div class="ttname"><a href="classldpk_1_1lookup__table.html">ldpk::lookup_table&lt; vec2_type &gt;</a></div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a48671e71653cd4f604c6f8f55a84f799"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a48671e71653cd4f604c6f8f55a84f799">ldpk::ldp_builtin::no_longer_uptodate_lut</a></div><div class="ttdeci">void no_longer_uptodate_lut()</div><div class="ttdoc">This class and the derived class mark the lookup table as obsolete when some parameter was changed...</div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:256</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_ac328b74c578aa5adf7f23285eb7ae28d"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#ac328b74c578aa5adf7f23285eb7ae28d">ldpk::ldp_builtin::get_num_builtin_parameters</a></div><div class="ttdeci">int get_num_builtin_parameters() const </div><div class="ttdoc">There are seven built-in parameters. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:271</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a6606d28b6b95a67fa50e462fd728e37b"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a6606d28b6b95a67fa50e462fd728e37b">ldpk::ldp_builtin::getBoundingBoxUndistort</a></div><div class="ttdeci">virtual void getBoundingBoxUndistort(double xa_in, double ya_in, double xb_in, double yb_in, double &amp;xa_out, double &amp;ya_out, double &amp;xb_out, double &amp;yb_out, int nx, int ny)</div><div class="ttdoc">Bounding box. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:391</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a494126e85487ed51de38c567abdcae69"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a494126e85487ed51de38c567abdcae69">ldpk::ldp_builtin::_critsec</a></div><div class="ttdeci">CRITICAL_SECTION _critsec</div><div class="ttdoc">The Mutex, used in derived classes, initialized in constructor. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:242</div></div>
<div class="ttc" id="namespaceldpk_html"><div class="ttname"><a href="namespaceldpk.html">ldpk</a></div><div class="ttdoc">The namespace of (most of the) things related to the Lens Distortion Plugin Kit. </div><div class="ttdef"><b>Definition:</b> ldpk.h:19</div></div>
<div class="ttc" id="classldpk_1_1box_html"><div class="ttname"><a href="classldpk_1_1box.html">ldpk::box</a></div><div class="ttdoc">A simple box class for double precision points in 2d. We will extend this as needed. </div><div class="ttdef"><b>Definition:</b> ldpk_vec2d.h:192</div></div>
<div class="ttc" id="classtde4__ld__plugin_html"><div class="ttname"><a href="classtde4__ld__plugin.html">tde4_ld_plugin</a></div><div class="ttdoc">Lens Distortion Plugin Base Class. </div><div class="ttdef"><b>Definition:</b> tde4_ld_plugin.h:29</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_ad2bbeafbc1fadf9a8975cb9de90549e8"><div class="ttname"><a href="classldpk_1_1lookup__table.html#ad2bbeafbc1fadf9a8975cb9de90549e8">ldpk::lookup_table::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Use reset() and next() to build a loop for generating positions. See example. </div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:191</div></div>
<div class="ttc" id="namespaceldpk_html_af2ea06f1ed4bc17dff8682c0cabbfe30"><div class="ttname"><a href="namespaceldpk.html#af2ea06f1ed4bc17dff8682c0cabbfe30">ldpk::para_builtin_enum</a></div><div class="ttdeci">para_builtin_enum</div><div class="ttdoc">An enum-type for built-in parameters. Also used to address elements in parameter name array...</div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:13</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_aa27eb18e62b7a3e1e3323c1b28f61f87"><div class="ttname"><a href="classldpk_1_1lookup__table.html#aa27eb18e62b7a3e1e3323c1b28f61f87">ldpk::lookup_table::init</a></div><div class="ttdeci">void init(int nx, int ny)</div><div class="ttdoc">Initialize a grid with nx * ny sample points. Implies reset(). </div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:72</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_a371a4a602a0dee64ab4be471c1c383e1"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#a371a4a602a0dee64ab4be471c1c383e1">ldpk::ldp_builtin::set_uptodate_lut</a></div><div class="ttdeci">void set_uptodate_lut(bool u)</div><div class="ttdoc">If a derived class computes the LUT, it must have write-access to this flag. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:259</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html">ldpk::ldp_builtin</a></div><div class="ttdoc">This class handles the built-in parameter and the lookup table. You may find it useful for your own d...</div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:31</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_abf9af2aadba2940b721986645130c7e2"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#abf9af2aadba2940b721986645130c7e2">ldpk::ldp_builtin::check_builtin_parameters</a></div><div class="ttdeci">void check_builtin_parameters()</div><div class="ttdoc">This method should be invoked by the derived classes in initializeParameters(). It write error messag...</div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:290</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_afb7166cc349973f3a3c69b818fdbf656"><div class="ttname"><a href="classldpk_1_1lookup__table.html#afb7166cc349973f3a3c69b818fdbf656">ldpk::lookup_table::get_current_initial_value</a></div><div class="ttdeci">vec2_type get_current_initial_value() const </div><div class="ttdoc">Appropriate initial value for calculating warp at current position obtained with get_p_current_fov()...</div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:235</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_af948515de1e3ebc1119023b21d94a9c2"><div class="ttname"><a href="classldpk_1_1lookup__table.html#af948515de1e3ebc1119023b21d94a9c2">ldpk::lookup_table::get_p_current_fov</a></div><div class="ttdeci">vec2_type get_p_current_fov() const </div><div class="ttdoc">Current position in normalized FOV-coordinates. This is the position you want to warp next...</div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:109</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_aef6d9baf1d9321bc764a2c6492fe2208"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#aef6d9baf1d9321bc764a2c6492fe2208">ldpk::ldp_builtin::get_lut</a></div><div class="ttdeci">const ldpk::lookup_table&lt; vec2_type &gt; &amp; get_lut() const </div><div class="ttdoc">The derived class has constant access, since it needs to consult it. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:265</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_aca0898bd49a2f2c19a4f4f8dac144d1d"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#aca0898bd49a2f2c19a4f4f8dac144d1d">ldpk::ldp_builtin::undistort_gnomonic</a></div><div class="ttdeci">virtual bool undistort_gnomonic(double x0, double y0, double &amp;x1, double &amp;y1)</div><div class="ttdoc">Model function Our base class presents the model functions along with the projection. Internally, we have to carefully keep apart the model function and the projection. For most distortion models, this is no problem, yet for fisheye models it is, so all non-gnomonic distortion classes will have to overwrite these. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:382</div></div>
<div class="ttc" id="ldpk__lookup__table_8h_html"><div class="ttname"><a href="ldpk__lookup__table_8h.html">ldpk_lookup_table.h</a></div></div>
<div class="ttc" id="ldpk__vec2d_8h_html"><div class="ttname"><a href="ldpk__vec2d_8h.html">ldpk_vec2d.h</a></div><div class="ttdoc">Double-valued vector and matrix class. </div></div>
<div class="ttc" id="classtde4__ld__plugin_html_a31128ad1bee0ea540a7764fbd1998bf5"><div class="ttname"><a href="classtde4__ld__plugin.html#a31128ad1bee0ea540a7764fbd1998bf5">tde4_ld_plugin::getJacobianMatrix</a></div><div class="ttdeci">virtual bool getJacobianMatrix(double x0, double y0, double &amp;m00, double &amp;m01, double &amp;m10, double &amp;m11)</div><div class="ttdoc">calculate the Jacobian matrix of the undistort()-Method. Overwrite this, if you know the Jacobian for...</div><div class="ttdef"><b>Definition:</b> tde4_ld_plugin.h:132</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_adbac9011ec420283903e339aa89e49b7"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#adbac9011ec420283903e339aa89e49b7">ldpk::ldp_builtin::set_builtin_parameter_value</a></div><div class="ttdeci">bool set_builtin_parameter_value(const char *identifier, double v)</div><div class="ttdoc">The return values indicates, if &amp;#39;identifier&amp;#39; refers to a built-in parameter. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:422</div></div>
<div class="ttc" id="classldpk_1_1lookup__table_html_a81ad0186a55f2e05d352b4a91dfd3529"><div class="ttname"><a href="classldpk_1_1lookup__table.html#a81ad0186a55f2e05d352b4a91dfd3529">ldpk::lookup_table::set_q_current_fov</a></div><div class="ttdeci">void set_q_current_fov(const vec2_type &amp;q_fov)</div><div class="ttdoc">Set value for given index pair. Index pairs out of bounds will raise an exception. Use this method to insert the warped position from warping p_current_fov. </div><div class="ttdef"><b>Definition:</b> ldpk_lookup_table.h:115</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_aefe00fe66885527a66086c7de7ada14e"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#aefe00fe66885527a66086c7de7ada14e">ldpk::ldp_builtin::get_builtin_parameter_type</a></div><div class="ttdeci">bool get_builtin_parameter_type(const char *identifier, tde4_ldp_ptype &amp;ptype) const </div><div class="ttdoc">The return values indicates, if &amp;#39;identifier&amp;#39; refers to a built-in parameter. Currently, all built-in parameters are double-valued. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:277</div></div>
<div class="ttc" id="classldpk_1_1ldp__builtin_html_ae33a7bacc31a24bb0635dfc7c745e3ec"><div class="ttname"><a href="classldpk_1_1ldp__builtin.html#ae33a7bacc31a24bb0635dfc7c745e3ec">ldpk::ldp_builtin::is_uptodate_lut</a></div><div class="ttdeci">bool is_uptodate_lut() const </div><div class="ttdoc">The derived class uses this in order to check if the lookup table needs an update. </div><div class="ttdef"><b>Definition:</b> ldpk_ldp_builtin.h:252</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
